<ErrorNull>
	
<!-- initiates perpetual zombie spawning -->
<set xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/triggered_effect[@trigger='onSelfEnteredGame']/@buff">buffStatusCheck01,buffStatusCheck02,enInitializeCvars</set>

<!-- give starting item -->
<set xpath="/entity_classes/entity_class[@name='playerMale']/property[contains(@name,'ItemsOnEnterGame')]/@value">bedrollBlockVariantHelper,apparelArmyPants,apparelArmyShirt,apparelWornBoots</set>


<!-- tags onSelfRespawn property for easier modification -->
<setattribute xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/triggered_effect[@trigger='onSelfRespawn']" name="id">respawn</setattribute>

<!-- ** drain food and water down to 20 units after each death ** -->
<insertAfter xpath="/entity_classes/entity_class/effect_group/triggered_effect[@id='respawn']">
	<triggered_effect trigger="onSelfRespawn" action="ModifyStats" stat="Food" operation="set" value="50"/>
	<triggered_effect trigger="onSelfRespawn" action="ModifyStats" stat="Water" operation="set" value="50"/>
</insertAfter>

<!-- ** reduce max health after each death, via enBuffDeathPenalty buff ** -->
<insertAfter xpath="/entity_classes/entity_class/effect_group/triggered_effect[@id='respawn']">
	<triggered_effect trigger="onSelfRespawn" action="AddBuff" target="self" buff="enBuffDeathPenalty">
		<requirement name="CVarCompare" cvar="$enDeathPenalty" operation="LT" value="1.0"/>
	</triggered_effect>
</insertAfter>

<!-- remove XP deficit from death -->
<set xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/passive_effect[@name='ExpDeficitPerDeathPercentage'][@value='.25']/@value">0</set>



<!-- remove vanilla buffs to prevent stats restore after death respawn. also re-run necessary tower defense buffs after respawn. -->
<set xpath="/entity_classes/entity_class[@name='playerMale']/effect_group/triggered_effect[@id='respawn']/@buff">buffStatusCheck01,buffStatusCheck02,enTowerDefenseRespawn</set>


<!-- how many seconds before zombie corpse despawns -->
<set xpath="/entity_classes/entity_class[@name='zombieTemplateMale']/property[@name='TimeStayAfterDeath']/@value">5</set>

<!-- increment score when zombie is killed -->
<append xpath="/entity_classes/entity_class[@name='zombieTemplateMale']/effect_group" >
	<triggered_effect trigger="onSelfDied" target="other" action="ModifyCVar" cvar="enScore" operation="add" value="1"/>
	<triggered_effect trigger="onSelfDied" target="other" action="ModifyCVar" cvar="enZombiesKilled" operation="add" value="1"/>
</append>

<!-- all zombies always provide loot drop -->
<set xpath="/entity_classes/entity_class/property[@name='LootDropProb']/@value">0.33</set>

<!-- define custom loot drop bag -->
<set xpath="/entity_classes/entity_class/property[@name='LootDropEntityClass']/@value">enLootClass</set>

<append xpath="/entity_classes">
	<entity_class name="enLootClass">	
		<property name="HideInSpawnMenu" value="true"/>
		<property name="Mesh" value="#Other/Items?Misc/sack_droppedprefab.prefab"/>
		<property name="ModelType" value="Custom"/>
		<property name="Prefab" value="Backpack"/>
		<property name="Class" value="EntityLootContainer"/>
		<property name="Parent" value="Backpack"/>
		<property name="IsEnemyEntity" value="false"/>
		<property name="TimeStayAfterDeath" value="1200"/>
		<property name="LootListOnDeath" value="enLootBag"/>
		<property name="Faction" value="none"/>
	</entity_class>
</append>

</ErrorNull>
